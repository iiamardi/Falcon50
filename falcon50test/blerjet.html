<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blerjet</title>
    <link rel="icon" href="img/logo/50white.webp">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://kit.fontawesome.com/20126e87c9.js" crossorigin="anonymous"></script>
    <style>
        .purchased-item {
            border: 1px solid #ccc;
            padding: 10px 30px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            background-color: #ffffff;
            gap: 20px;
            cursor: pointer; /* Change cursor to pointer */
        }
        .purchased-item img {
            margin-right: 10px;
        }
        .delete-button {

            font-size: 20px;
            background: none;
            border: none;
            color: red;
            cursor: pointer;
            margin-left: auto; /* Aligns the button to the right */
        }
        .order-details {
            display: none; /* Initially hidden */
            border: 1px solid #ccc;
            padding: 20px;
            margin-top: 20px;
            background: #f9f9f9;
            
        }
        .det{
            background-color: #ffffff;
        }
    </style>
</head>
<body>
    <section id="section-one">
    
        <div class="topbar">
        <h1 class="topbar-content">
            Mbështetu tek ne. Dërgesa 100% të sigurta, kudo në Kosovë.
          </h1>
        </div>
        <header>
          <div class="logo-container">
            <a href="index.html">
            <img src="img/logo/falcon50.webp" alt="" class="logo">
            </a>
          </div>
          <div class="for-container">
            <input type="text"  id="searchbar" placeholder="Kërko produkte..." oninput="searchProduct()">
            
        </div>
        <ul id="product-list" style="display: none;"></ul>     
          </div>
          <nav>
            <ul>
              <li><a href="cart.html"><i class="fa-solid fa-heart"></i></a></li>
              <li><a href="blerjet.html"><i class="fa-solid fa-cart-shopping"></i></a></li>
              <li><a href="welcome.html"><i class="fa-solid fa-user"></i></a></li>
            </ul>
          </nav>
        </header>
    
          <main>
            <div class="nav-main-container">
            <div class="navbar-main">
              <i class="fa-solid fa-bars"></i>
              <nav>
                <ul>
                  <li><a href="" ><span class="active">Kategorite</span></a></li>
                  <li><a href="">Outlet</a></li>
                  <li><a href="">Qfare ka te re</a></li>
                </ul>
              </nav>
            </div>
            <div class="nav-main2">
              <img class="appleimg" src="https://iqq6kf0xmf.gjirafa.net/images/ce80ffe8-09e5-4635-8c44-45dced59df48/ce80ffe8-09e5-4635-8c44-45dced59df48.webp?w=160" alt="">
              <div class="i">
              <i class="fa-regular fa-comment"></i>
              <h1>Chat</h1>
              </div>
            </div>
            </div>
            </main>

        <h1>Blerjet Tuaja</h1>
        <div id="purchased-items"></div>
        <div id="order-details" class="order-details"></div> <!-- Order details section -->
    </section>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const purchasedItems = JSON.parse(localStorage.getItem("purchasedProducts")) || [];
            const purchasedItemsContainer = document.getElementById("purchased-items");

            if (purchasedItems.length === 0) {
                purchasedItemsContainer.innerHTML = "<p>Nuk keni blerje!</p>";
            } else {
                const itemsList = purchasedItems.map((item, index) => `
                    <div class="purchased-item">
                        <img src="${item.image}" alt="${item.name}" style="max-width: 100px;">
                        <h2>${item.name}</h2><br>
                        <button class="delete-button" onclick="deleteItem(${index})">
                            <i class="fa-solid fa-trash"></i><br>
                        </button>
                    </div>
                `).join("");
                purchasedItemsContainer.innerHTML = itemsList;
            }
        });

        function deleteItem(index) {
            const purchasedItems = JSON.parse(localStorage.getItem("purchasedProducts")) || [];
            purchasedItems.splice(index, 1); // Remove the item at the specified index
            localStorage.setItem("purchasedProducts", JSON.stringify(purchasedItems)); // Update localStorage
            location.reload(); // Reload the page to reflect changes
        }
        document.addEventListener("DOMContentLoaded", function() {
    const purchasedItems = JSON.parse(localStorage.getItem("purchasedProducts")) || [];
    const purchasedItemsContainer = document.getElementById("purchased-items");

    if (purchasedItems.length === 0) {
        purchasedItemsContainer.innerHTML = "<p>Nuk keni blerje!</p>";
    } else {
        const itemsList = purchasedItems.map((item, index) => `
            <div class="purchased-item" onclick="showOrderDetails(${index})">
                <img src="${item.image}" alt="${item.name}" style="max-width: 100px;">
                <h2>${item.name}</h2>
               
                <button class="delete-button" onclick="deleteItem(event, ${index})">
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>
        `).join("");
        purchasedItemsContainer.innerHTML = itemsList;
    }
});

function showOrderDetails(index) {
    const purchasedItems = JSON.parse(localStorage.getItem("purchasedProducts")) || [];
    const orderDetails = document.getElementById("order-details");
    const item = purchasedItems[index];

    // Funksioni për të gjeneruar një numër të rastësishëm me 6 shifra
    function generateRandomNumber() {
        return Math.floor(100000 + Math.random() * 900000); // Numër i rastësishëm nga 100000 deri në 999999
    }

    // Gjeneroni numrin e rastësishëm
    const randomNumber = generateRandomNumber();

    // Kontrolloni nëse detajet e porosisë janë tashmë të dukshme
    if (orderDetails.style.display === "block") {
        orderDetails.style.display = "none"; // Fshihni detajet e porosisë
    } else {
        orderDetails.innerHTML = `
        <div class="det">
            <h2>Detajet e Porosisë</h2>
            <img src="${item.image}" alt="${item.name}" style="max-width: 300px;">
            <p><strong>Emri:</strong> ${item.name}</p>
            <p><strong>Çmimi për njësi:</strong> ${item.price}</p>
            <p><strong>Shuma:</strong> ${item.quantity}</p>
            <p><strong>Çmimi Final:</strong> ${item.finalPrice} </p>
            <p><strong>Numri i porosise: </strong>#${randomNumber}</p>
            <!-- Shtoni numrin e rastësishëm këtu -->
        </div>
        `;
        orderDetails.style.display = "block"; // Shfaqni detajet e porosisë
    }
}

function deleteItem(event, index) {
    event.stopPropagation(); // Parandaloni ngjarjen e klikimit që të ngjitet te elementi
    const purchasedItems = JSON.parse(localStorage.getItem("purchasedProducts")) || [];
    purchasedItems.splice(index, 1); // Hiqni elementin në indeksin e specifikuar
    localStorage.setItem("purchasedProducts", JSON.stringify(purchasedItems)); // Përditësoni localStorage
    location.reload(); // Rilidhni faqen për të reflektuar ndryshimet
}
    </script>
    <script src="js/searchbar.js"></script>
</body>
</html>